---
import Layout from '../layouts/Layout.astro';
import Card from '../components/Card.astro';
import { db, Usuarios, Libros } from 'astro:db';

const usuarios = await db.select().from(Usuarios);
const libros = await db.select().from(Libros);

---

<Layout title="Welcome to Astro.">
	<main>
		<h2>Usuarios</h2>
        {
            usuarios.map(({nombreUsuario}) => (
              <article>
                <p>Usuario: {nombreUsuario}</p>
                <iframe title="" allowfullscreen style="border:none;" width="300" height="300" src="https://www.pacdora.com/share?filter_url=ps3aycnabf&source=code" ></iframe>
              </article>
            ))
        }
        {
            libros.map(({tituloLibro, nombreAutor, portadaLibro}) => (
              <article>
                <p>Titulo: {tituloLibro}</p>
                <p>Autor: {nombreAutor}</p>
                <img src={portadaLibro} alt={`Portada de ${tituloLibro}`}>
              </article>
            ))
        }
	</main>

    
</Layout>
<script>
    function getAllBooks() {
        fetch('/api/books')
        .then(response => response.json())
        .then(data => {
        	console.log(data);
        })
        .catch(error => console.error('Error:', error));
    }
	getAllBooks();
  </script>
